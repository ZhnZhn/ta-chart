{"version":3,"sources":["../../../../src/components/drawer/page-stocks/loadIex.js"],"names":["C","BASE_URL","DF_PERIOD","_crUri","symbol","Error","loadIex","dataAction","loading","fetch","then","status","res","json","Array","isArray","loadData","providerTitle","itemTitle","data","catch","loadFailed","console","log","err","trailing"],"mappings":";;;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,IAAI;AACRC,YAAU,sCADF;AAERC,aAAW;AAFH,CAAV;;AAKA,IAAMC,SAAS,SAATA,MAAS,SAAU;AACvB,MAAI,CAACC,MAAL,EAAa;AACX,UAAM,IAAIC,KAAJ,CAAU,iBAAV,CAAN;AACD;AACD,SAAUL,EAAEC,QAAZ,SAAwBG,MAAxB,eAAwCJ,EAAEE,SAA1C;AACD,CALD;;AAOA,IAAMI,UAAU,SAAVA,OAAU,OAA4B;AAAA,MAAzBF,MAAyB,QAAzBA,MAAyB;AAAA,MAAjBG,UAAiB,QAAjBA,UAAiB;;AAC1CA,aAAWC,OAAX;AACAC,QAAMN,OAAOC,MAAP,CAAN,EACEM,IADF,CACO,eAAO;AAAA,QACJC,MADI,GACOC,GADP,CACJD,MADI;;AAEZ,QAAIA,UAAQ,GAAR,IAAeA,SAAO,GAA1B,EAA8B;AAC3B,aAAOC,IAAIC,IAAJ,EAAP;AACF,KAFD,MAEO;AACJ,YAAM,IAAIR,KAAJ,qBAA4BM,MAA5B,CAAN;AACF;AACF,GARD,EASCD,IATD,CASM,gBAAQ;AACZ,QAAKI,MAAMC,OAAN,CAAcF,IAAd,CAAL,EAA2B;AACzBN,iBAAWS,QAAX,CAAoB;AAClBC,uBAAe,cADG;AAElBC,mBAAWd,MAFO;AAGlBe,cAAM,sBAAON,IAAP;AAHY,OAApB;AAKD,KAND,MAMO;AACL,YAAM,IAAIR,KAAJ,CAAU,wBAAV,CAAN;AACD;AACF,GAnBD,EAoBCe,KApBD,CAoBO,eAAO;AACZb,eAAWc,UAAX;AACAC,YAAQC,GAAR,CAAYC,GAAZ;AACD,GAvBD;AAwBD,CA1BD;;kBA4Be,wBAASlB,OAAT,EAAkB,IAAlB,EAAwB,EAAEmB,UAAU,KAAZ,EAAxB,C","file":"loadIex.js","sourcesContent":["\r\nimport throttle from '../../../utils/throttle'\r\nimport toData from './toData'\r\n\r\nconst C = {\r\n  BASE_URL: 'https://api.iextrading.com/1.0/stock',\r\n  DF_PERIOD: '1y'\r\n};\r\n\r\nconst _crUri = symbol => {\r\n  if (!symbol) {\r\n    throw new Error(\"Symbol is empty\");\r\n  }\r\n  return `${C.BASE_URL}/${symbol}/chart/${C.DF_PERIOD}`;\r\n};\r\n\r\nconst loadIex = ({ symbol, dataAction }) => {\r\n  dataAction.loading()\r\n  fetch(_crUri(symbol))\r\n   .then(res => {\r\n    const { status } = res;\r\n    if (status>=200 && status<400){\r\n       return res.json();\r\n    } else {\r\n       throw new Error(`Loading Error: ${status}`);\r\n    }\r\n  })\r\n  .then(json => {\r\n    if ( Array.isArray(json) ) {\r\n      dataAction.loadData({\r\n        providerTitle: 'IEX Platform',\r\n        itemTitle: symbol,\r\n        data: toData(json)\r\n      })\r\n    } else {\r\n      throw new Error(\"Json response is empty\");\r\n    }\r\n  })\r\n  .catch(err => {\r\n    dataAction.loadFailed()\r\n    console.log(err)\r\n  });\r\n}\r\n\r\nexport default throttle(loadIex, 3000, { trailing: false })\r\n"]}