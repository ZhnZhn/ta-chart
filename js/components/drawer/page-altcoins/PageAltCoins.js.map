{"version":3,"sources":["../../../../src/components/drawer/page-altcoins/PageAltCoins.jsx"],"names":["crExchange","pageFns","crExchanges","crTimeframes","DF_TIMEFRAME","S","ROOT","height","DIV_BTS","paddingLeft","BT_LIVE_UPDATE","display","PageAltCoins","style","onPrevPage","AppValue","appSettings","dataAction","onLiveUpdate","onStopUpdate","AppLiveUpdating","isLiveUpdating","reducer","initialState","state","dispatch","exchange","pair","isMarkets","exchanges","markets","timeframes","setTimeframes","timeframe","setTimeframe","refExchange","proxy","type","ALTCOIN","EXCHANGES_SET","current","exchImpl","onSelectExchange","item","value","EXCHANGE_SET","onSelectTimeframe","onSelectMarket","PAIR_SET","undefined"],"mappings":"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","file":"PageAltCoins.js","sourcesContent":["import React, { useState, useReducer, useEffect, useRef, useContext } from 'react'\r\n\r\nimport AppValue from '../../contexts/AppValue'\r\nimport AppLiveUpdating from '../../contexts/AppLiveUpdating'\r\n\r\nimport BackMenuBt from '../BackMenuBt'\r\nimport CoinSelect from './CoinSelect'\r\nimport FlatButton from '../../zhn-m/FlatButton'\r\n\r\nimport reducer from './reducer'\r\nimport initialState from './initialState'\r\nimport ALTCOIN from './enumAltcoin'\r\n\r\nimport loadMarkets from './loadMarkets'\r\nimport loadPair from './loadPair'\r\n\r\nimport pageFns from './pageFns';\r\n\r\nconst {\r\n  crExchange,\r\n  crExchanges,\r\n  crTimeframes\r\n} = pageFns;\r\n\r\n\r\nconst DF_TIMEFRAME = '1d';\r\n\r\nconst S = {\r\n  ROOT: {\r\n    height: 400\r\n  },\r\n  DIV_BTS: {\r\n    paddingLeft: 8\r\n  },\r\n  BT_LIVE_UPDATE: {\r\n    display: 'block',\r\n    paddingLeft: 8\r\n  }\r\n};\r\n\r\n\r\nconst PageAltCoins = ({ style, onPrevPage }) => {\r\n  const {\r\n    appSettings,\r\n    dataAction,\r\n    onLiveUpdate, onStopUpdate\r\n  } = useContext(AppValue)\r\n  , { isLiveUpdating } = useContext(AppLiveUpdating)\r\n  const [state, dispatch] = useReducer(reducer, initialState)\r\n  , { exchange, pair, isMarkets,\r\n      exchanges, markets\r\n  } = state\r\n  , [timeframes, setTimeframes] = useState([])\r\n  , [timeframe, setTimeframe] = useState(DF_TIMEFRAME)\r\n  , refExchange = useRef(null)\r\n  , proxy = appSettings.proxy();\r\n\r\n  useEffect(() => {\r\n    dispatch({\r\n      type: ALTCOIN.EXCHANGES_SET,\r\n      exchanges: crExchanges()\r\n    })\r\n  }, [])\r\n\r\n  useEffect(()=>{\r\n    if (exchange) {\r\n      refExchange.current = crExchange(exchange, proxy)\r\n      setTimeframe(DF_TIMEFRAME)\r\n      setTimeframes(crTimeframes(refExchange.current.timeframes))\r\n      loadMarkets({\r\n        dispatch, exchange,\r\n        exchImpl: refExchange.current\r\n      })\r\n    }\r\n  }, [exchange, proxy])\r\n\r\n  useEffect(() => {\r\n    if (pair && timeframe) {\r\n      loadPair({\r\n        exchange, pair,\r\n        timeframe: timeframe,\r\n        exchImpl: refExchange.current,\r\n        dataAction\r\n      })\r\n    }\r\n  }, [pair, timeframe])\r\n\r\n  const onSelectExchange = (item) => {\r\n    if (item && item.value) {\r\n      dispatch({\r\n        type: ALTCOIN.EXCHANGE_SET,\r\n        exchange: item.value\r\n      })\r\n    }\r\n  }\r\n\r\n  const onSelectTimeframe = (item) => {\r\n    setTimeframe((item && item.value) || DF_TIMEFRAME)\r\n  }\r\n\r\n  const onSelectMarket = (item) => {\r\n    dispatch({\r\n      type: ALTCOIN.PAIR_SET,\r\n      pair: item && item.value || undefined\r\n    })\r\n  }\r\n\r\n  return  (\r\n    <div style={{ ...S.ROOT, ...style }}>\r\n      <BackMenuBt\r\n        onClick={onPrevPage}\r\n      />\r\n      <CoinSelect\r\n        exchanges={exchanges}\r\n        onSelectExchange={onSelectExchange}\r\n        isMarkets={isMarkets}\r\n        markets={markets}\r\n        onSelectMarket={onSelectMarket}\r\n        timeframes={timeframes}\r\n        onSelectTimeframe={onSelectTimeframe}\r\n      />\r\n      { (exchange === 'binance' && timeframe === '1m') && <div\r\n         style={S.DIV_BTS}>\r\n          <FlatButton\r\n            caption={isLiveUpdating ? 'Stop Updating' : 'Live Updating 1min'}\r\n            onClick={isLiveUpdating ? onStopUpdate : () => onLiveUpdate(pair)}\r\n          />\r\n       </div>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PageAltCoins\r\n"]}